{% extends "base.html" %}

{% block title %}{{ run.name }} - RedstoneReporter{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Back Button -->
    <div>
        <a href="/" class="inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-800">
            <svg class="mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Back to Dashboard
        </a>
    </div>

    {% include "partials/run_detail_content.html" %}
</div>

<script>
function toggleDetails(caseId) {
    var detailsDiv = document.getElementById('case-details-' + caseId);
    var button = document.getElementById('btn-' + caseId);
    var icon = document.getElementById('icon-' + caseId);
    var text = document.getElementById('text-' + caseId);

    // Check if details are already loaded
    if (button.dataset.loaded) {
        // Toggle visibility
        var isHidden = detailsDiv.classList.contains('hidden');

        if (isHidden) {
            detailsDiv.classList.remove('hidden');
            icon.style.transform = 'rotate(180deg)';
            text.textContent = 'Hide Details';
        } else {
            detailsDiv.classList.add('hidden');
            icon.style.transform = 'rotate(0deg)';
            text.textContent = 'Show Details';
        }
    } else {
        // First time - show loading and let HTMX load content
        detailsDiv.classList.remove('hidden');
        text.textContent = 'Loading...';

        // Mark as loaded after HTMX completes
        setTimeout(function() {
            button.dataset.loaded = 'true';
            text.textContent = 'Hide Details';
            icon.style.transform = 'rotate(180deg)';
        }, 500);
    }
}
</script>

{% endblock %}
